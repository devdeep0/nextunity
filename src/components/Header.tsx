"use client";

import React, { Suspense,useState } from 'react';
import { createWallet, inAppWallet } from "thirdweb/wallets";
import { AutoConnect } from "thirdweb/react";
import Image from "next/image";
import { useActiveAccount } from "thirdweb/react";
import thirdwebIcon from "@public/thirdweb.svg";
import { shortenAddress } from "thirdweb/utils";
import { Button } from "@headlessui/react";
import { client, wallet } from "@/app/constant";

import Link from "next/link";



function Header() {
    const account = useActiveAccount();
    const [balance, setBalance] = useState<string >('0')
    async function fetchBalance() {
        try {
          const response = await fetch(
            `https://c227651d.engine-usw2.thirdweb.com/contract/10/0x0F49C6E6F9Ff7DD867e5B89fF1Fe0aeEE105A435/erc20/balance-of?wallet_address=${account}`,
            {
              method: "GET",
              headers: {
                Authorization: `Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiIweDQ4RTk1MUUzM0M1ZUZDOEYyQTc3MUE1ZDUzZTdEZEVhMjYzNTVCRTgiLCJzdWIiOiIweDI5NzY5ZTA0Mjc1Nzk1Yzg3NDQ2QzdFZTEwMTAyMUM2YTY3NUNGMDYiLCJhdWQiOiJ0aGlyZHdlYi5jb20iLCJleHAiOjQ4ODQ1NTg1MTksIm5iZiI6MTczMDk1ODUxOSwiaWF0IjoxNzMwOTU4NTE5LCJqdGkiOiIwZjc5ZTZmMC1lZGIxLTQ5ZWUtYWRjNC01Mzc4ODYzYTg0ZTEiLCJjdHgiOnsicGVybWlzc2lvbnMiOiJBRE1JTiJ9fQ.MHg3YzJiNTQ2MDcyODk2ZjBiZDI3OTdiNDQ3Yjk0YTI4MDkxYmViOTJjZDAxMmMxZGM3ZGQwMzE1MzYwZDc2ZGU2NjcwZmE0YzRkMGE1MGNjZmQxMmM3OWYzY2IyM2E1OWNiN2NkOTAxODljZmEyNzMyMWUwNTJjY2VmYTRhOGMxZDFi`,
              },
            }
          );
    
          if (!response.ok) {
            throw new Error(`Failed to fetch balance: ${response.statusText}`);
          }
    
          const data = await response.json();
          setBalance(data.result.displayValue);
          console.log("Balance data:", data);
        } catch (error) {
          console.error("Error fetching balance:", error);
        }
      }
    return (
        <header className='h-24 z-20 p-5 w-full relative bg-black'>
            <div className='flex flex-row items-center justify-between'>
                     <div><svg width="80" height="80" viewBox="0 0 150 150" fill="none" xmlns="http://www.w3.org/2000/svg">
 <path fill-rule="evenodd" clip-rule="evenodd" d="M28.3671 21.2133C26.9545 21.225 25.7295 22.2149 25.4318 23.5959L18.0389 57.8962C18.0232 57.9691 18.0103 58.0418 18 58.1142L77.9549 59.8965C81.7659 55.0231 90.4522 40.4668 78.73 27.2043C72.8764 22.0012 69.9548 21.2705 59.3945 21.036C57.7105 20.9986 54.951 20.993 53.2666 21.007C49.9298 21.0348 42.9533 21.0927 28.3671 21.2133ZM28.2931 63.4992L83.6188 64.7513C83.7346 65.5335 83.4554 66.3796 82.6595 67.0267C81.6823 67.8212 80.5836 68.6324 79.3955 69.3779C78.2798 70.078 77.6258 71.3585 77.8482 72.6567L82.4411 99.4719C82.757 101.316 81.3367 103 79.4659 103H60.6968C59.2277 103 57.972 101.942 57.7222 100.495L53.5565 76.3466C53.3367 75.0728 52.2318 74.1421 50.9392 74.1421C49.6862 74.1421 48.6036 75.0179 48.3419 76.2433L43.1372 100.612C42.8397 102.005 41.6094 103 40.1852 103H23.1281C21.2068 103 19.7744 101.229 20.1763 99.35L27.5375 64.9388C27.6564 64.3829 27.9239 63.8904 28.2931 63.4992ZM96.0806 65.0334L118.791 65.5474L116.616 76.3215C116.238 78.1908 117.668 79.9374 119.575 79.9374H129.473C131.391 79.9374 132.822 81.702 132.427 83.5784L128.839 100.604C128.544 102 127.312 103 125.885 103H91.5386C89.612 103 88.1784 101.22 88.5896 99.3373L96.059 65.1416C96.0669 65.1055 96.0741 65.0694 96.0806 65.0334ZM109.955 60.8478L86.1366 60.1397C85.6992 59.4877 85.5114 58.663 85.6957 57.8176L92.9621 24.4791C93.2644 23.0922 94.492 22.1034 95.9114 22.1034H112.907C114.834 22.1034 116.267 23.8839 115.856 25.7662L108.854 57.8161C108.593 59.0107 109.075 60.1643 109.955 60.8478ZM46.4014 43.6498C45.0495 43.6498 43.8784 44.5871 43.5823 45.9061C43.1759 47.7169 44.5576 49.4358 46.4134 49.4281L56.9758 49.3841C58.6901 49.3841 61.5867 47.9062 60.5226 44.7139C59.9906 43.5323 59.5177 43.5327 56.9758 43.6498H46.4014Z" fill="white"/>
 <path d="M129.392 128.483C129.332 128.483 129.303 128.453 129.303 128.394V125.875C129.303 125.816 129.332 125.786 129.392 125.786H131.91C131.97 125.786 131.999 125.816 131.999 125.875V128.394C131.999 128.453 131.97 128.483 131.91 128.483H129.392Z" fill="white"/>
 <path d="M124.06 128.706C123.257 128.706 122.522 128.505 121.853 128.104C121.199 127.688 120.672 127.146 120.271 126.477C119.885 125.794 119.691 125.043 119.691 124.226V123.201C119.691 123.127 119.729 123.09 119.803 123.09H122.299C122.358 123.09 122.388 123.127 122.388 123.201V124.226C122.388 124.717 122.552 125.14 122.878 125.497C123.205 125.838 123.599 126.009 124.06 126.009C124.52 126.009 124.914 125.831 125.241 125.474C125.568 125.118 125.731 124.702 125.731 124.226C125.731 123.676 125.375 123.201 124.661 122.8C124.424 122.666 124.052 122.458 123.547 122.176C123.042 121.894 122.566 121.626 122.121 121.374C121.303 120.898 120.694 120.304 120.293 119.591C119.907 118.863 119.714 118.045 119.714 117.139C119.714 116.307 119.914 115.564 120.315 114.91C120.717 114.242 121.244 113.714 121.898 113.328C122.566 112.942 123.287 112.749 124.06 112.749C124.847 112.749 125.568 112.949 126.221 113.35C126.89 113.737 127.417 114.264 127.804 114.933C128.205 115.586 128.406 116.322 128.406 117.139V118.967C128.406 119.026 128.376 119.056 128.316 119.056H125.82C125.761 119.056 125.731 119.026 125.731 118.967L125.709 117.139C125.709 116.619 125.545 116.196 125.219 115.869C124.892 115.542 124.505 115.378 124.06 115.378C123.599 115.378 123.205 115.557 122.878 115.913C122.552 116.255 122.388 116.664 122.388 117.139C122.388 117.629 122.492 118.038 122.7 118.365C122.908 118.692 123.287 119.004 123.837 119.301C123.911 119.345 124.052 119.427 124.26 119.546C124.483 119.65 124.721 119.776 124.973 119.925C125.226 120.059 125.449 120.177 125.642 120.281C125.85 120.385 125.976 120.452 126.021 120.482C126.764 120.898 127.351 121.411 127.782 122.02C128.212 122.614 128.428 123.35 128.428 124.226C128.428 125.073 128.227 125.838 127.826 126.522C127.44 127.19 126.912 127.725 126.244 128.126C125.59 128.513 124.862 128.706 124.06 128.706Z" fill="white"/>
 <path d="M110.023 128.483C109.963 128.483 109.934 128.446 109.934 128.372L109.978 113.061C109.978 113.001 110.008 112.971 110.067 112.971H114.346C115.193 112.971 115.951 113.179 116.62 113.595C117.288 113.997 117.816 114.531 118.202 115.2C118.588 115.869 118.781 116.597 118.781 117.384C118.781 118.023 118.633 118.617 118.336 119.167C118.053 119.717 117.712 120.163 117.311 120.504C117.741 120.935 118.076 121.433 118.313 121.998C118.551 122.562 118.67 123.156 118.67 123.78C118.67 124.642 118.462 125.43 118.046 126.143C117.63 126.856 117.065 127.428 116.352 127.859C115.654 128.275 114.874 128.483 114.012 128.483H110.023ZM112.653 119.123H114.346C114.866 119.123 115.282 118.944 115.594 118.588C115.921 118.216 116.085 117.815 116.085 117.384C116.085 116.909 115.914 116.5 115.572 116.158C115.23 115.802 114.822 115.624 114.346 115.624H112.653V119.123ZM112.63 125.764H114.012C114.547 125.764 115.008 125.571 115.394 125.185C115.78 124.783 115.973 124.315 115.973 123.78C115.973 123.246 115.78 122.785 115.394 122.399C115.008 122.012 114.547 121.819 114.012 121.819H112.653L112.63 125.764Z" fill="white"/>
 <path d="M99.6641 128.372L102.428 113.061C102.442 113.001 102.48 112.971 102.539 112.971H105.771C105.83 112.971 105.867 113.001 105.882 113.061L108.534 128.372C108.549 128.446 108.519 128.483 108.445 128.483H105.971C105.912 128.483 105.875 128.446 105.86 128.372L105.615 126.745H102.584L102.338 128.372C102.324 128.446 102.286 128.483 102.227 128.483H99.7532C99.6938 128.483 99.6641 128.446 99.6641 128.372ZM103.029 124.36H105.169L104.255 118.097L104.121 117.273L104.032 118.097L103.029 124.36Z" fill="white"/>
 <path d="M91.6536 128.483C91.5942 128.483 91.5645 128.446 91.5645 128.372L91.5867 113.083C91.5867 113.009 91.6239 112.971 91.6982 112.971H94.172C94.2463 112.971 94.2834 113.009 94.2834 113.083L94.2612 125.742H98.8522C98.9265 125.742 98.9637 125.779 98.9637 125.853V128.372C98.9637 128.446 98.9265 128.483 98.8522 128.483H91.6536Z" fill="white"/>
 <path d="M78.9856 128.483C78.9262 128.483 78.8965 128.446 78.8965 128.372L78.9188 113.061C78.9188 113.001 78.9485 112.971 79.0079 112.971H86.162C86.2214 112.971 86.2511 113.009 86.2511 113.083V115.579C86.2511 115.638 86.2214 115.668 86.162 115.668H81.5932V119.145H86.162C86.2214 119.145 86.2511 119.175 86.2511 119.234L86.2734 121.752C86.2734 121.812 86.2437 121.842 86.1843 121.842H81.5932V125.742H86.1843C86.2437 125.742 86.2734 125.779 86.2734 125.853V128.394C86.2734 128.453 86.2437 128.483 86.1843 128.483H78.9856Z" fill="white"/>
 <path d="M68.2337 128.483C68.1742 128.483 68.1445 128.446 68.1445 128.372L68.1891 113.061C68.1891 113.001 68.2188 112.971 68.2783 112.971H72.7802C73.5825 112.971 74.318 113.172 74.9866 113.573C75.67 113.959 76.2123 114.487 76.6135 115.155C77.0147 115.809 77.2153 116.552 77.2153 117.384C77.2153 117.934 77.1335 118.432 76.9701 118.877C76.8067 119.308 76.6135 119.68 76.3906 119.992C76.1678 120.289 75.9672 120.512 75.7889 120.66C76.5912 121.552 76.9924 122.599 76.9924 123.803L77.0147 128.372C77.0147 128.446 76.9775 128.483 76.9032 128.483H74.3848C74.3254 128.483 74.2957 128.461 74.2957 128.416V123.803C74.2957 123.268 74.1025 122.807 73.7162 122.421C73.3448 122.02 72.8842 121.819 72.3344 121.819H70.8635L70.8412 128.372C70.8412 128.446 70.8115 128.483 70.7521 128.483H68.2337ZM70.8635 119.145H72.7802C73.2408 119.145 73.6494 118.974 74.006 118.632C74.3625 118.29 74.5408 117.874 74.5408 117.384C74.5408 116.909 74.3625 116.5 74.006 116.158C73.6642 115.817 73.2556 115.646 72.7802 115.646H70.8635V119.145Z" fill="white"/>
 <path d="M61.9932 128.706C61.2057 128.706 60.4777 128.505 59.8091 128.104C59.1405 127.688 58.6056 127.138 58.2045 126.455C57.8182 125.771 57.625 125.021 57.625 124.204L57.6696 113.061C57.6696 113.001 57.6993 112.971 57.7587 112.971H60.2548C60.3143 112.971 60.344 113.001 60.344 113.061V124.204C60.344 124.709 60.5 125.14 60.812 125.497C61.1389 125.838 61.5326 126.009 61.9932 126.009C62.4687 126.009 62.8624 125.838 63.1744 125.497C63.5013 125.14 63.6647 124.709 63.6647 124.204V113.061C63.6647 113.001 63.6944 112.971 63.7539 112.971H66.25C66.3094 112.971 66.3391 113.001 66.3391 113.061L66.3837 124.204C66.3837 125.036 66.1831 125.794 65.782 126.477C65.3957 127.161 64.8682 127.703 64.1996 128.104C63.5459 128.505 62.8104 128.706 61.9932 128.706Z" fill="white"/>
 <path d="M51.1994 128.483C51.14 128.483 51.1103 128.446 51.1103 128.372V115.668H48.213C48.1387 115.668 48.1016 115.631 48.1016 115.557L48.1238 113.061C48.1238 113.001 48.1536 112.971 48.213 112.971H56.682C56.7563 112.971 56.7934 113.001 56.7934 113.061V115.557C56.7934 115.631 56.7637 115.668 56.7043 115.668H53.7847L53.807 128.372C53.807 128.446 53.7773 128.483 53.7178 128.483H51.1994Z" fill="white"/>
 <path d="M39.1153 128.483C39.0411 128.483 39.0039 128.446 39.0039 128.372L39.0485 113.061C39.0485 113.001 39.0782 112.971 39.1376 112.971H43.4167C44.7836 112.971 45.8608 113.387 46.6483 114.219C47.4506 115.051 47.8518 116.181 47.8518 117.607C47.8518 118.662 47.6437 119.576 47.2277 120.348C46.8117 121.121 46.2694 121.715 45.6008 122.131C44.9322 122.547 44.2042 122.755 43.4167 122.755H41.7229V128.372C41.7229 128.446 41.6857 128.483 41.6115 128.483H39.1153ZM41.7229 120.059H43.4167C43.8921 120.059 44.3007 119.836 44.6425 119.39C44.999 118.929 45.1773 118.335 45.1773 117.607C45.1773 117.028 45.0213 116.552 44.7093 116.181C44.3973 115.809 43.9664 115.624 43.4167 115.624L41.7229 115.646V120.059Z" fill="white"/>
 <path d="M32.8526 128.706C32.0651 128.706 31.3371 128.505 30.6685 128.104C29.9999 127.688 29.465 127.138 29.0638 126.455C28.6775 125.771 28.4844 125.021 28.4844 124.204L28.5289 113.061C28.5289 113.001 28.5587 112.971 28.6181 112.971H31.1142C31.1736 112.971 31.2034 113.001 31.2034 113.061V124.204C31.2034 124.709 31.3594 125.14 31.6714 125.497C31.9983 125.838 32.392 126.009 32.8526 126.009C33.328 126.009 33.7218 125.838 34.0338 125.497C34.3607 125.14 34.5241 124.709 34.5241 124.204V113.061C34.5241 113.001 34.5538 112.971 34.6132 112.971H37.1094C37.1688 112.971 37.1985 113.001 37.1985 113.061L37.2431 124.204C37.2431 125.036 37.0425 125.794 36.6413 126.477C36.255 127.161 35.7276 127.703 35.059 128.104C34.4052 128.505 33.6698 128.706 32.8526 128.706Z" fill="white"/>
 <path d="M18.0891 128.483C18.0297 128.483 18 128.446 18 128.372L18.0446 113.061C18.0446 113.001 18.0743 112.971 18.1337 112.971H22.6356C23.438 112.971 24.1734 113.172 24.842 113.573C25.5255 113.959 26.0678 114.487 26.469 115.155C26.8701 115.809 27.0707 116.552 27.0707 117.384C27.0707 117.934 26.989 118.432 26.8256 118.877C26.6621 119.308 26.469 119.68 26.2461 119.992C26.0232 120.289 25.8227 120.512 25.6444 120.66C26.4467 121.552 26.8479 122.599 26.8479 123.803L26.8701 128.372C26.8701 128.446 26.833 128.483 26.7587 128.483H24.2403C24.1809 128.483 24.1512 128.461 24.1512 128.416V123.803C24.1512 123.268 23.958 122.807 23.5717 122.421C23.2002 122.02 22.7397 121.819 22.1899 121.819H20.719L20.6967 128.372C20.6967 128.446 20.667 128.483 20.6076 128.483H18.0891ZM20.719 119.145H22.6356C23.0962 119.145 23.5048 118.974 23.8614 118.632C24.218 118.29 24.3963 117.874 24.3963 117.384C24.3963 116.909 24.218 116.5 23.8614 116.158C23.5197 115.817 23.1111 115.646 22.6356 115.646H20.719V119.145Z" fill="white"/>
 </svg></div>
        
 <AutoConnect client={client} wallets={[wallet]}/>
 <div className="flex justify-center items-center h-full pr-2">
 {/* <Button className="inline-flex items-center gap-2 rounded-[4px] font-raj underline underline-offset-4 decoration-[#19AE00] decoration-4 decoration-solid bg-transparent border-2 border-white py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-600 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white">0x181871415415418148</Button>   */}

          {account ? 
            (
            <> 
            <Button onClick={() => (window as any).Telegram.WebApp.openLink(`https://etherscan.io/address/${account.address}`)} className="inline-flex items-center gap-2 rounded-[4px] font-raj underline underline-offset-4 decoration-[#19AE00] decoration-4 decoration-solid bg-transparent border-2 border-white py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-600 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white">{shortenAddress(account.address)}</Button>  
            <div className="text-white text-sm mt-1">
                                    Balance: {parseFloat(balance).toFixed(4)} odc.
                                </div>
            </>
            ) 
          : (
              <p className="text-sm text-zinc-400">fetching smart account</p>
            )}      

        </div>
        <div className='absolute right-0 '>
            <Image
                 src='/ui/PLAY.png'
                 alt=''
                 height={30}
                 width={30}
                 />
            </div>
            </div>
            <div className='absolute -bottom-11 right-0 '>
                <Image
                 src='/ui/DIagonal_2.png'
                 alt=''
                 height={150}
                 width={150}
                 />
            </div>
            
        </header>
    );
}

export default Header;


